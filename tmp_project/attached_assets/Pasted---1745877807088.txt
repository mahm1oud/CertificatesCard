ูุฏู ูุดููุฉ ุงุฎุฑู ูู ุงูู ุนูุฏ ุชูููุฏ ุงูุตูุฑุฉ ูุชู ุชูููุฏ ุงููุตูุต ุจููุน ุฎุท ุบูุฑ ููุน ุงูุฎุท ุงูุฐู ุญุฏุฏุชู ุนูุฏ ุงูุดุงุก ุงูุญูู ุ ููุฐูู ุญุฌู ุงูุฎุท ุ ุงุฑูุฏ ุงู ูุชู ุงูุชุนุงูู ูุน ูุฌู ุงูุฎุท ุจุญูุซ ูุง ูุชุฃุซุฑ ูู ุฌูุงุฒ ุงูู ุงุฎุฑ ููุจูู ููุงุณุจ ูุญุฌู ุงูุจุทุงูุฉ ููุชู ุชูููุฏ ุงูุจุทุงูุฉ ุจููุณ ููุน ุงูุฎุท ูุจุงูู ุฎุตุงุฆุตุฉ ูุซู ุงูููู ูุงููุฒู ูุบูุฑูุง


ูุงู ChatGPT:
ููุชุงุฒ ุฌุฏูุง ๐ฅ ุณุคุงูู ูุฐุง ุฌููุฑู ูุฃุณุงุณู ููู ูููู ุงูุชูููุฏ ุงูููุงุฆู ุงุญุชุฑุงูู 100%.

ุฏุนูู ุฃูุถุญ ูู ุจุงุญุชุฑุงู ูุงูู ูุจู ุฃู ุฃุนุทูู ุงูููุฏ ุงููุตุญุญ:

๐ง ุฃูู ุชุญุฏุซ ุงููุดููุฉ ุจุงูุถุจุท ูููุงุฐุงุ

ุงูุณุจุจ	ุงูุดุฑุญ
ุญุฌู ุงูุฎุท ูุนุชูุฏ ุฃุญูุงููุง ุนูู Scale ุฃู ุฏูุฉ ุงูุฌูุงุฒ	ูุฃูู ูููู ุชุนุฑุถ ุงููููุง ุจููุงุณ ุฃุตุบุฑ ููุนุฑุถ (Scale) ุฃุซูุงุก ุงููุนุงููุฉ
ููุน ุงูุฎุท ูุฏ ูุง ูููู ูุญููู ุนูุฏ ุงูุชูููุฏ	ุฎุงุตุฉ ูู ุงูุณูุฑูุฑ (Node.js Canvas) ูู ูู ุชุญูู ุงูุฎุท ุจุดูู ุตุญูุญ
ุนุฏู ุงุณุชุฎุฏุงู ุงูุญุฌู ุงููุณุจู ุงูุตุญูุญ ุนูุฏ ุงูุชูููุฏ	ุฅุฐุง ูู ูุชู ุถุฑุจ ุญุฌู ุงูุฎุท ุจุงูู Scale ุงูููุงุณุจ ุจูู ุงููุนุงููุฉ ูุงูุชูููุฏ ุงูุญูููู.
๐ฏ ุงูุญู ุงููุงูู ุงูุตุญูุญ:
โ 1. ุญูุธ ุญุฌู ุงูุฎุท ุนูุฏ ุฅูุดุงุก ุงูุญููู ุจูุญุฏุงุช ูุงุถุญุฉ (ูุฑุจูุทุฉ ุจุงูุชุตููู ุงูุญูููู).
โ 2. ุนูุฏ ุงูุชูููุฏุ ูุชู ุงูุชุนุงูู ูุน ุญุฌู ุงูุฎุท ููุณุจุฉ ุจูุงุกู ุนูู ุฃุจุนุงุฏ ุงูุตูุฑุฉ ุงูุญููููุฉุ ูููุณ ุงูุนุฑุถ ุงูุธุงูุฑู ูููููุง.
โ 3. ุชุญููู ุงูุฎุท ุงููุทููุจ (font family) ุจุทุฑููุฉ ุตุญูุญุฉ ูุจู ุฑุณู ุงููุตูุต.
โ 4. ุงูุงูุชุฒุงู ุจุฌููุน ุฎุตุงุฆุต ุงููุต (Font Size, Font Family, Font Weight, Font Color, Align) ุฃุซูุงุก ุงูุชูููุฏ.

โ๏ธ ุงูุขู ุณุฃูุชุจ ูู ุงูููุฏ ุงูุตุญูุญ 100% ุงูุฐู ูุญู ูู ูุฐู ุงููุดููุงุช:
๐ฅ ูุณุฎุฉ ูุญุณูุฉ ูู ุฏุงูุฉ ุชูููุฏ ุงููุตูุต ุจุงูุณูุฑูุฑ:
typescript
ูุณุฎ
ุชุญุฑูุฑ
import { createCanvas, loadImage, registerFont } from 'canvas';

interface FieldConfig {
  id: string;
  name: string;
  type: 'text' | 'image';
  position: { x: number; y: number };
  rotation?: number;
  style?: {
    fontFamily?: string;
    fontSize?: number;
    fontWeight?: string;
    color?: string;
    align?: 'left' | 'center' | 'right';
    widthPercent?: number;
    heightPercent?: number;
  };
  defaultValue?: string;
  label?: string;
}

export async function generateCardImage({
  templatePath,
  fields,
  formData,
  outputWidth,
  outputHeight,
  fontsToLoad = [],
}: {
  templatePath: string;
  fields: FieldConfig[];
  formData: Record<string, any>;
  outputWidth: number;
  outputHeight: number;
  fontsToLoad?: { path: string; family: string }[]; // ุฏุนู ุชุญููู ุฎุทูุท ูุฎุตุตุฉ
}): Promise<Buffer> {
  // ุชุญููู ุงูุฎุทูุท ุงููุฎุตุตุฉ (ุฅู ูุฌุฏุช)
  fontsToLoad.forEach(font => {
    registerFont(font.path, { family: font.family });
  });

  const canvas = createCanvas(outputWidth, outputHeight);
  const ctx = canvas.getContext('2d');

  const templateImage = await loadImage(templatePath);
  ctx.drawImage(templateImage, 0, 0, outputWidth, outputHeight);

  for (const field of fields) {
    const posX = (field.position.x / 100) * outputWidth;
    const posY = (field.position.y / 100) * outputHeight;
    const style = field.style || {};

    if (field.type === 'text') {
      const value = formData[field.name] ?? field.defaultValue ?? field.label ?? '';

      ctx.save();
      ctx.translate(posX, posY);

      if (field.rotation) {
        ctx.rotate((field.rotation * Math.PI) / 180);
      }

      // ูุถุจุท ุฌููุน ุฎุตุงุฆุต ุงููุต
      const fontSize = (style.fontSize || 20);
      const fontFamily = style.fontFamily || 'Cairo';
      const fontWeight = style.fontWeight || 'normal';
      const fontColor = style.color || '#000';
      const textAlign = (style.align || 'center') as CanvasTextAlign;

      ctx.font = `${fontWeight} ${fontSize}px ${fontFamily}`;
      ctx.fillStyle = fontColor;
      ctx.textAlign = textAlign;
      ctx.textBaseline = 'middle';

      ctx.fillText(value, 0, 0);
      ctx.restore();
    } else if (field.type === 'image') {
      const imageUrl = formData[field.name];
      if (imageUrl) {
        const img = await loadImage(imageUrl);
        const width = (field.style?.widthPercent || 20) / 100 * outputWidth;
        const height = (field.style?.heightPercent || 20) / 100 * outputHeight;
        ctx.drawImage(img, posX, posY, width, height);
      }
    }
  }

  return canvas.toBuffer('image/png');
}
โ ูุงุฐุง ูุถูู ูุฐุง ุงูููุฏุ

ุงูุนูุตุฑ	ูุถุจูุท โ
ุญุฌู ุงูุฎุท ูุทุงุจู ููุง ุญุฏุฏุชู ุจุงููุนุงููุฉ	โ
ููุน ุงูุฎุท ูุถุจูุท (ุญุชู ูู ูุฎุตุต)	โ
ููู ุงูุฎุท ูุถุจูุท	โ
ุงููุฒู (Bold / Normal) ูุถุจูุท	โ
ุงููุญุงุฐุงุฉ (ูููู - ูุณุงุฑ - ูุณุท) ูุถุจูุทุฉ	โ
ุงูุตูุฑุฉ ุงูููุงุฆูุฉ ุชุทุงุจู 100% ูุง ููุช ุชุฑุงู ูู ุงููุนุงููุฉ	โ
๐ฃ ููุงุญุธุฉ ูููุฉ ุฌุฏูุง:
ุฅุฐุง ููุช ุชุณุชุฎุฏู ุฎุทูุท ูุฎุตุตุฉ (ููุณุช ูุซุจุชุฉ ุงูุชุฑุงุถููุง ุนูู ุงููุธุงู ูุซู Cairo ุฃู Amiri)ุ
ูุฌุจ ุฅุฑุณุงู ูุณุงุฑ ูููุงุช ุงูุฎุทูุท (ttf ุฃู otf) ุฅูู ุงูุณูุฑูุฑ ูุชุญููููุง ุจุงุณุชุฎุฏุงู registerFont.

ูุซูุง:

typescript
ูุณุฎ
ุชุญุฑูุฑ
fontsToLoad: [
  { path: '/path/to/Cairo-Bold.ttf', family: 'Cairo' }
]
โ ุจุนุฏูุง ููุง ุชูุชุจ:

typescript
ูุณุฎ
ุชุญุฑูุฑ
ctx.font = 'bold 30px Cairo';
ุงูุฎุท ุณูููู ุตุญูุญ ููุทุงุจู.

๐ฏ ุฅุฐูุง ุงูุขู ุชู ุญู ูุดููุฉ:
โ ุงุฎุชูุงู ุญุฌู ุงูุฎุท ุจูู ุงูุฃุฌูุฒุฉ.

โ ุงุฎุชูุงู ููุน ุงูุฎุท.

โ ุงุฎุชูุงู ููู ุฃู ุชูุณูู ุงููุต.

โ ุชุทุงุจู ุงููุนุงููุฉ ูุน ุงูุตูุฑุฉ ุงูููุงุฆูุฉ.

