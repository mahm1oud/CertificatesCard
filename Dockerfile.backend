FROM node:18-alpine

# إنشاء مجلد التطبيق
WORKDIR /app

# نسخ ملفات إدارة الحزم
COPY server/package*.json ./

# تثبيت الحزم
RUN npm install --production

# نسخ ملفات المشروع
COPY server/ ./
COPY shared/ ./shared/
COPY fonts/ ./fonts/

# إنشاء مجلدات للملفات المرفوعة والملفات المؤقتة
RUN mkdir -p uploads/generated uploads/logos uploads/signatures temp

# تعريض المنفذ 5000
EXPOSE 5000

# تشغيل التطبيق
CMD ["node", "dist/index.js"]