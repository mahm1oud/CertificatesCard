#!/bin/bash

# ุณูุฑูุจุช ุจูุงุก ุงููุดุฑูุน ููุฅูุชุงุฌ (Frontend ู Backend)

echo "๐๏ธ ุจุฏุก ุนูููุฉ ุจูุงุก ุงููุดุฑูุน ููุฅูุชุงุฌ..."

# ุจูุงุก ุงููุฑููุช ุฅูุฏ
echo "๐จ ุจูุงุก ุงููุงุฌูุฉ ุงูุฃูุงููุฉ (Frontend)..."
cd client && npm run build
if [ $? -ne 0 ]; then
  echo "โ ูุดู ุจูุงุก ุงููุงุฌูุฉ ุงูุฃูุงููุฉ!"
  exit 1
fi
echo "โ ุชู ุจูุงุก ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ุจูุฌุงุญ."

# ุจูุงุก ุงูุจุงู ุฅูุฏ
echo "๐จ ุจูุงุก ุงููุงุฌูุฉ ุงูุฎูููุฉ (Backend)..."
cd ../server && npm run build
if [ $? -ne 0 ]; then
  echo "โ ูุดู ุจูุงุก ุงููุงุฌูุฉ ุงูุฎูููุฉ!"
  exit 1
fi
echo "โ ุชู ุจูุงุก ุงููุงุฌูุฉ ุงูุฎูููุฉ ุจูุฌุงุญ."

# ุงูุนูุฏุฉ ูููุฌูุฏ ุงูุฑุฆูุณู
cd ..

# ูุณุฎ ุงูุฃุตูู ูุงููููุงุช ุงููุดุชุฑูุฉ
echo "๐ฆ ูุณุฎ ุงูุฃุตูู ูุงููููุงุช ุงููุดุชุฑูุฉ..."
./scripts/copy-assets.sh

# ุฅูุดุงุก ูุณุฎุฉ ูู ูุฌูุฏ uploads ูู ุงููุงุฌูุฉ ุงูุฎูููุฉ
if [ -d "uploads" ] && [ "$(ls -A uploads)" ]; then
  echo "๐ค ูุณุฎ ุงููููุงุช ุงููุฑููุนุฉ ุงูููุฌูุฏุฉ..."
  cp -r uploads/* server/dist/uploads/
fi

echo "๐ ุชู ุจูุงุก ุงููุดุฑูุน ุจูุฌุงุญ!"
echo "๐ ุงููููุงุช ุงููุงุชุฌุฉ:"
echo "  - ูุงุฌูุฉ ุฃูุงููุฉ: ./client/dist/"
echo "  - ูุงุฌูุฉ ุฎูููุฉ: ./server/dist/"
echo ""
echo "๐ ูููุดุฑ ุนูู ุงุณุชุถุงูุงุช ูููุตูุฉ:"
echo "  1. ุงูุดุฑ ูุญุชููุงุช client/dist ุนูู ุงุณุชุถุงูุฉ Frontend (ูุซู Netlify ุฃู Vercel)"
echo "  2. ุงูุดุฑ ูุญุชููุงุช server/dist ุนูู ุงุณุชุถุงูุฉ Backend (ูุซู Render ุฃู Heroku)"
echo "  3. ุชุฃูุฏ ูู ุชุนุฏูู ูููุงุช .env ููุฅุดุงุฑุฉ ุฅูู ุงูุนูุงููู ุงูุตุญูุญุฉ"