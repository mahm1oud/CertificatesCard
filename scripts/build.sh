#!/bin/bash

# ุณูุฑูุจุช ุจูุงุก ุงููุดุฑูุน ููุฅูุชุงุฌ (Frontend ู Backend)

echo "๐๏ธ ุจุฏุก ุนูููุฉ ุจูุงุก ุงููุดุฑูุน ููุฅูุชุงุฌ..."

# ุจูุงุก ุงููุฑููุช ุฅูุฏ
echo "๐จ ุจูุงุก ุงููุงุฌูุฉ ุงูุฃูุงููุฉ (Frontend)..."
cd client && npm run build
if [ $? -ne 0 ]; then
  echo "โ ูุดู ุจูุงุก ุงููุงุฌูุฉ ุงูุฃูุงููุฉ!"
  exit 1
fi
echo "โ ุชู ุจูุงุก ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ุจูุฌุงุญ."

# ุจูุงุก ุงูุจุงู ุฅูุฏ
echo "๐จ ุจูุงุก ุงููุงุฌูุฉ ุงูุฎูููุฉ (Backend)..."
cd ../server && npm run build
if [ $? -ne 0 ]; then
  echo "โ ูุดู ุจูุงุก ุงููุงุฌูุฉ ุงูุฎูููุฉ!"
  exit 1
fi
echo "โ ุชู ุจูุงุก ุงููุงุฌูุฉ ุงูุฎูููุฉ ุจูุฌุงุญ."

# ูุณุฎ ุงููููุงุช ุงููุดุชุฑูุฉ
echo "๐ ูุณุฎ ุงููููุงุช ุงููุดุชุฑูุฉ ุงููุทููุจุฉ..."
mkdir -p ./dist/shared
cp -r ../shared ./dist/

# ุฅูุดุงุก ูููุงุช ููุญูุงุธ ุนูู ูููู ุงููุฌูุฏ
mkdir -p ./dist/uploads
mkdir -p ./dist/uploads/generated
mkdir -p ./dist/temp
mkdir -p ./dist/fonts

# ูุณุฎ ุงูุฎุทูุท
echo "๐ค ูุณุฎ ูููุงุช ุงูุฎุทูุท..."
cp -r ../fonts ./dist/

echo "๐ ุชู ุจูุงุก ุงููุดุฑูุน ุจูุฌุงุญ!"
echo "๐ ุงููููุงุช ุงููุงุชุฌุฉ:"
echo "  - ูุงุฌูุฉ ุฃูุงููุฉ: ./client/dist/"
echo "  - ูุงุฌูุฉ ุฎูููุฉ: ./server/dist/"
echo ""
echo "๐ ูููุดุฑ ุนูู ุงุณุชุถุงูุงุช ูููุตูุฉ:"
echo "  1. ุงูุดุฑ ูุญุชููุงุช client/dist ุนูู ุงุณุชุถุงูุฉ Frontend"
echo "  2. ุงูุดุฑ ูุญุชููุงุช server/dist ู shared/ ุนูู ุงุณุชุถุงูุฉ Backend"
echo "  3. ุชุฃูุฏ ูู ุชุนุฏูู ูููุงุช .env ููุฅุดุงุฑุฉ ุฅูู ุงูุนูุงููู ุงูุตุญูุญุฉ"