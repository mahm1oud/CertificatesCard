#!/bin/bash

# ุฅุนุฏุงุฏ ุงููุดุฑูุน ุจุชุซุจูุช ุงูุญุฒู ูุฅุนุฏุงุฏ ุงูุจูุฆุฉ

echo "๐ง ุฅุนุฏุงุฏ ูุดุฑูุน Certificates Card..."

# ุชูููู ุงููุฌูุฏุงุช ุงููุดุชุฑูุฉ ูุงูุฃุตูู
echo "๐ง ุชูููู ุงููุฌูุฏุงุช ุงููุดุชุฑูุฉ ูุงูุฃุตูู..."
./scripts/configure-assets.sh

# ุชุซุจูุช ุงูุญุฒู ููู Frontend
echo "๐ฆ ุชุซุจูุช ุญุฒู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ..."
cd client && npm install
if [ $? -ne 0 ]; then
  echo "โ๏ธ ูุดู ุชุซุจูุช ุญุฒู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ. ูุฑุฌู ุงูุชุญูู ูู ุณุฌู ุงูุฃุฎุทุงุก."
else
  echo "โ ุชู ุชุซุจูุช ุญุฒู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ุจูุฌุงุญ."
fi
cd ..

# ุชุซุจูุช ุงูุญุฒู ููู Backend
echo "๐ฆ ุชุซุจูุช ุญุฒู ุงููุงุฌูุฉ ุงูุฎูููุฉ..."
cd server && npm install
if [ $? -ne 0 ]; then
  echo "โ๏ธ ูุดู ุชุซุจูุช ุญุฒู ุงููุงุฌูุฉ ุงูุฎูููุฉ. ูุฑุฌู ุงูุชุญูู ูู ุณุฌู ุงูุฃุฎุทุงุก."
else
  echo "โ ุชู ุชุซุจูุช ุญุฒู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุจูุฌุงุญ."
fi
cd ..

# ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ
if [ -f ".env" ] && [ -n "$(grep DATABASE_URL .env)" ]; then
  echo "๐๏ธ ุชุญุฏูุซ ูุฎุทุท ูุงุนุฏุฉ ุงูุจูุงูุงุช..."
  npm run db:push
else
  echo "โ๏ธ ูู ูุชู ุงูุนุซูุฑ ุนูู ูุชุบูุฑ ุงูุจูุฆุฉ DATABASE_URL. ุณูุชู ุชุฎุทู ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช."
fi

echo "โ ุชู ุฅุนุฏุงุฏ ุงููุดุฑูุน ุจูุฌุงุญ!"
echo ""
echo "๐ ููุนูู ูู ุจูุฆุฉ ุงูุชุทููุฑ:"
echo "  - ูุชุดุบูู ุงููุธุงู ุงููุชูุงูู: npm run dev"
echo "  - ูุชุดุบูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ููุท: npm run dev:frontend"
echo "  - ูุชุดุบูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ููุท: npm run dev:backend"
echo ""
echo "๐๏ธ ูุจูุงุก ุงููุดุฑูุน ูููุดุฑ:"
echo "  - ูุจูุงุก ุงููุดุฑูุน ุจุงููุงูู: npm run build"
echo "  - ูุจูุงุก ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ููุท: npm run build:frontend"
echo "  - ูุจูุงุก ุงููุงุฌูุฉ ุงูุฎูููุฉ ููุท: npm run build:backend"
echo ""
echo "๐ ููุฒูุฏ ูู ุงููุนูููุงุช ุญูู ุงููุดุฑุ ุฑุงุฌุน ููู DEPLOY.md"